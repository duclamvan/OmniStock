Jasn캩, tohle je "Vibe Coding" prompt, kter칳 m콢쬰te zkop칤rovat a vlo쬴t p콏칤mo do Replit AI (Agenta).

Je napsan칳 v angli캜tin캩, proto쬰 Replit Agent (a LLM modely obecn캩) ch치pou komplexn칤 logiku datab치z칤 a vztah콢 l칠pe v angli캜tin캩, ale popisuje p콏esn캩 to, co jsme 콏e코ili (pravidlo 17 a archivaci).

游늶 Zkop칤rujte tento text do Replitu:
I need to implement two advanced features for my Warehouse Management System (Davie Supply) using Drizzle ORM and TypeScript.

Feature 1: Virtual SKU / Packaging Logic (The "Bucket" Rule) I sell products like "Acrylic Powder" in two forms: a small Jar (660g) and a large Bucket (25lbs). Physically, I only stock Jars. One Bucket equals exactly 17 Jars.

Schema: Update the products table to add masterProductId (self-relation) and inventoryDeductionRatio (number).

Logic: Update the backend inventory service (deductInventory). When a product is sold, check if it has a masterProductId.

If yes (it's a Bucket), calculate Quantity Sold * inventoryDeductionRatio (e.g., 1 * 17) and deduct that amount from the Master Product's stock at the specific location.

If no, deduct normally.

Audit: Ensure the inventory transaction log clearly states: "Sold 1x Bucket (Virtual), deducted 17x Jars from Master SKU".

Feature 2: Historical Data Archive (Snapshot Strategy) I have legacy CSV data (2019-2025) that I need to import for financial reporting (Revenue/Profit), but I don't want to pollute my active orders or products tables with old data.

Schema: Create a new independent table called historical_orders. It should have fields for legacyInvoiceId, date, totalRevenue, totalProfit, currency.

Snapshots: Instead of foreign keys to products/customers (which might not exist anymore), use JSONB columns: customerSnapshot (stores name, address, FB_ID) and itemsSnapshot (stores the array of items, prices, and quantities from the CSV).

Script: Create a script import_history.ts that reads CSV files from a folder named import_data. It needs to handle header files (OrdersID) and item files (Orders), merging them based on Invoice Number before inserting into the DB.

Co tento prompt ud캩l치?
Vysv캩tl칤 kontext: 콎칤k치 AI, 쬰 d캩l치te WMS syst칠m a pou쮂셨치te Drizzle ORM (aby v캩d캩l, jak upravit datab치zi).

Definuje "Bucket" probl칠m: Jasn캩 popisuje, 쬰 Bucket je jen virtu치ln칤 obal pro 17 Jars a 쬰 se m치 ode캜칤tat ze skladu "rodi캜e" (Master).

Definuje Archivaci: P콏ikazuje vytvo콏it tabulku historical_orders s JSON sloupci (Snapshoty), aby se nemusely vytv치콏et star칠 produkty, a 쮂멳치 o skript na import CSV.

Sta캜칤 to takto vlo쬴t a Replit by m캩l za캜칤t generovat zm캩ny v datab치zi a k칩du.